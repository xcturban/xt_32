<HTML>
    <HEAD>
        <META http-equiv=Content-Language content=zh-cn>
        <META http-equiv=Content-Type content="text/html; charset=utf-8">
        <META http-equiv="Pragma" content="no-cache">
        <META content="MSHTML 6.00.2800.1106" name=GENERATOR>
	<link href="/css/main.css" rel="stylesheet"/>
	<script language=javascript src=/js/Common.js type=text/javascript></script>
    </HEAD>
<BODY onresize="Resize(this);" onload="bd_load()">
<iframe style="display:none" name=db onload="db_load()" ></iframe>
        <CENTER>
            <FORM method=GET action=/cgi-bin/response_x2i.cgi onsubmit="return on_submit()">
		<input type=hidden name=obj_x2i id=id_obj_x2i value=sip_cfg.x2i >
		<input type=hidden name=obj_ret id=id_obj_ret value=/cache/SipCfg.htm id=id_obj_ret >
		<input type=hidden name=obj_sh value=response_SipCfg.sh >
<DIV class=container >
  <div class=title>
    <div class=title_left ><img width="7" height="24" src="/images/arc.gif" complete="complete" /></div>
    <div class=title_right ><?cgi string=str.sip_options ?></div>
  </div>
  <div class=div_main_edge>
  <DIV class=div_main>	


      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.be_sip_enable ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=sip_enable value=1 onclick="set_sip_enable(1);" ><div class="l40 radio_text"><?cgi string=str.enable_use ?></div>
	  <input class=radio type=radio name=sip_enable value=0 onclick="set_sip_enable(0);" ><div class="l40 radio_text"><?cgi string=str.disable_use ?></div>
	</DIV>
      </DIV>

      <div id=id_div_sip class=c_none >

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.sip_server_ip ?>:</DIV>
        <DIV class=class_col2>
                 <INPUT class="text l100" maxLength=32 id=sip_ip name=sip_ip value="" >&nbsp;:
                 <INPUT class="text l40" maxLength=5 id=sip_port name=sip_port value="" > (<?cgi string=str.default ?>5060)
	</DIV>
      </DIV>

      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.user ?>:</DIV>
      	<DIV class=class_col2>
                <INPUT class="text l100" maxLength=20 name=board_1_sip_username value="" >
	</DIV>
      </DIV>
      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.key ?>:</DIV>
      	<DIV class=class_col2>
                <INPUT class="text l100" maxLength=20 name=board_1_sip_passwd value="" >
	</DIV>
      </DIV>
      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.net_port ?>:</DIV>
      	<DIV class=class_col2>
	        <INPUT class="text l40" maxLength=5 name=board_1_sip_port value="" >
	</DIV>
      </DIV>
      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.audio_port ?>:</DIV>
      	<DIV class=class_col2>
        	<INPUT class="text l40" maxLength=5 name=board_1_sip_audio_rtp_port value="" >
	</DIV>
      </DIV>
      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.vedio_port ?>:</DIV>
      	<DIV class=class_col2>
        	<INPUT class="text l40" maxLength=5 name=board_1_sip_vedio_rtp_port value="" >
	</DIV>
      </DIV>

      <DIV class=class_row>
      	<DIV class=class_col1><?cgi string=str.be_sip_mast_enable ?>:</DIV>
      	<DIV class=class_col2>
          <input class=radio type=radio name=board_1_call_type value=2 onclick="call_type(2);" ><div class="l40 radio_text"><?cgi string=str.enable_use ?></div>
	  <input class=radio type=radio name=board_1_call_type value=1 onclick="call_type(1);" ><div class="l40 radio_text"><?cgi string=str.disable_use ?></div>
	</DIV>
      </DIV>
      <div id="id_div_sip_mast" class=c_none >
      <DIV class=class_row >
        <DIV class=class_col1><?cgi string=str.phone_target ?>1:</DIV>
        <DIV class=class_col2>
                 <INPUT class="text l100" maxLength=15 id=sip_target_1 name=sip_target_1 value="" >&nbsp;
	</DIV>
      </DIV>
      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.phone_target ?>2:</DIV>
        <DIV class=class_col2>
                 <INPUT class="text l100" maxLength=15 id=sip_target_2 name=sip_target_2 value="" >&nbsp;
	</DIV>
      </DIV>
      <input type=hidden name=sip_target value="" />
      </div><!-- id_div_sip_mast -->
      </div><!-- id_div_sip  -->

  </div><!-- div_main -->
  <DIV class=class_row1>
    <DIV class=class_r1c1>
      <INPUT class=button value=<?cgi string=str.save ?> type=submit >&nbsp; 
    </DIV>
  </DIV>
  </div><!-- div_main_edge -->
</DIV>
            </FORM>
        </CENTER>
        <META http-equiv="Pragma" content="no-cache">

<!-- ************* help page , must add iniHelpButton() in js segment ****************** -->
<div class="help_container">
  <div class="help_left"><div class="help_top_space"></div><div class="help_button_0" id="help_button" ></div></div>
  <div class="help_right_0" id="help_right">
    <div class="help_head" ><?cgi string=str.help_message ?></div>
    <iframe name=help class="help_text" frameBorder=0 src="" ></iframe>
  </div>
</div>
<!-- ************* help page end ****************** -->

    </BODY>

<script language="javascript">
function bd_load(){
  window.frames["db"].document.location="/ini/sys_cfg.txt?time="+(new Date()).getTime();
  var ret = location.toString().substring(location.toString().lastIndexOf("/")+1, location.toString().indexOf(".htm")+4);
  window.frames["help"].document.location="/cache/Help"+ret+"?time="+(new Date()).getTime();
  iniHelpButton();
}

function db_load(){
  var str=window.frames["db"].document.body.innerHTML;
  str = str.replace("<pre>", "");
  str = str.replace("</pre>", "");
  str = str.replace("<PRE>", "");
  str = str.replace("</PRE>", "");

  var db=ini2json(str);
  document.forms[0].sip_ip.value=db.sip.ip;
  document.forms[0].sip_port.value=db.sip.port;
  document.forms[0].board_1_sip_username.value=db.board_1.sip_username;
  document.forms[0].board_1_sip_passwd.value=db.board_1.sip_passwd;
  document.forms[0].board_1_sip_port.value=db.board_1.sip_port;
  document.forms[0].board_1_sip_audio_rtp_port.value=db.board_1.sip_audio_rtp_port;
  document.forms[0].board_1_sip_vedio_rtp_port.value=db.board_1.sip_vedio_rtp_port;

  document.forms[0].sip_target.value=db.sip.target;

  put_radio("sip_enable", db.sip.enable );
  put_radio("board_1_call_type", db.board_1.call_type );

  divDecode(document.forms[0].sip_target.value);
  set_sip_enable(get_radio("sip_enable"));
  call_type(get_radio("board_1_call_type"));
}

function on_submit(){
	var ret;
  $("id_obj_ret").value=urlEncode($("id_obj_ret").value);

	document.forms[0].sip_target.value = divEncode();
	//ret = IsIp(document.getElementById("sip_ip").value);
	ret = IsPort(document.getElementById("sip_port").value);
	ret = ret && IsPort(document.getElementById("board_1_sip_port").value);
	ret = ret && IsPort(document.getElementById("board_1_sip_audio_rtp_port").value);
	ret = ret && IsPort(document.getElementById("board_1_sip_vedio_rtp_port").value);
	if(ret == true){
  if(confirm("<?cgi string=str.enable_changing_after_reboot ?>")){
    return true;
  }else{
    return false;
  }
	}
	else{
		return false;
	}
}

function divDecode(str){
	var obj;
	var ret="";
	obj=str.split(".");
  document.forms[0].sip_target_1.value=obj[0];
  document.forms[0].sip_target_2.value=obj[1];
}
function divEncode(){
  var ret="";
  ret += document.forms[0].sip_target_1.value;
  ret += ".";
  ret += document.forms[0].sip_target_2.value;
  ret += ".";
  return ret;
}
function setValue(id,val){
	$(id).value=val;
}

function set_sip_enable(type){
  if(type!=1){
    $("id_div_sip").className="c_none";
  }else{
    $("id_div_sip").className="c_block";
  }
}

function call_type(type){
  if(type!=2){
    $("id_div_sip_mast").className="c_none";
  }else{
    $("id_div_sip_mast").className="c_block";
  }
}

</script>
</HTML>
