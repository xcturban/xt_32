<HTML>
<HEAD>
<META http-equiv=Content-Language content=zh-cn>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META http-equiv="Pragma" content="no-cache">
<META content="MSHTML 6.00.2800.1106" name=GENERATOR>
<link rel="stylesheet" href="/css/main.css"/>
<script language=javascript type=text/javascript src=/js/Common.js ></script>
</HEAD>
<BODY onresize="Resize(this);" onload="bd_load()">
<iframe style="display:none" name=db onload="db_load()" ></iframe>
        <CENTER>
            <FORM method=GET action=/cgi-bin/response_x2i.cgi onsubmit="return on_submit()">
		<input type=hidden name=obj_x2i value=talk_cfg.x2i >
		<input type=hidden name=obj_sh value=response_TalkCfg.sh >
		<input type=hidden name=obj_ret value=/cache/TalkCfg.htm id=id_obj_ret >
<DIV class=container >
  <div class=title>
    <div class=title_left ><img width="7" height="24" src="/images/arc.gif" complete="complete" /></div>
    <div class=title_right ><?cgi string=str.talk_options ?></div>
  </div>
  <div class=div_main_edge>
  <DIV class=div_main>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talk_in_volume ?>:</DIV>
        <DIV class=class_col2>
            <select name=talk_cfg_volume_in class="l100" >
            <script>select_option(0, 16, 0, "", "");</script>
            </select>
	</DIV>
      </DIV>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talk_out_volume ?>:</DIV>
        <DIV class=class_col2>
            <select name=talk_cfg_volume_out class="l100" >
            <script>select_option(0, 16, 0, "", "");</script>
            </select>
	</DIV>
      </DIV>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talk_alert_volume ?>:</DIV>
        <DIV class=class_col2>
            <select name=talk_cfg_volume_ring class="l100" >
            <script>select_option(0, 16, 0, "", "");</script>
            </select>
	</DIV>
      </DIV>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.encode_mode ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_is_pcm value=0 ><div class="l40 radio_text">ADPCM</div>
	  <input class=radio type=radio name=talk_cfg_is_pcm value=1 ><div class="l40 radio_text">PCM</div>
	</DIV>
      </DIV>
      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.sample_rate ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_sample value=0 ><div class="l40 radio_text">8K</div>
	  <input class=radio type=radio name=talk_cfg_sample value=1 ><div class="l40 radio_text">22K</div>
	</DIV>
      </DIV>
      <DIV class=class_row style="display:none;">
        <DIV class=class_col1><?cgi string=str.in_channel ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_mode_in value=1 ><div class="l40 radio_text"><?cgi string=str.mic_in ?></div>
	  <input class=radio type=radio name=talk_cfg_mode_in value=2 ><div class="l40 radio_text"><?cgi string=str.line_in ?></div>
	</DIV>
      </DIV>

      <DIV class=class_row style="display:none;">
        <DIV class=class_col1><?cgi string=str.out_channel ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_mode_out value=1 ><div class="l40 radio_text"><?cgi string=str.speaker_out ?></div>
	  <input class=radio type=radio name=talk_cfg_mode_out value=2 ><div class="l40 radio_text"><?cgi string=str.line_out ?></div>
	</DIV>
      </DIV>
      <DIV class=class_row style="display:none;">
        <DIV class=class_col1><?cgi string=str.key_calling ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_key_down_call value=0 ><div class="l40 radio_text"><?cgi string=str.up_calling ?></div>
	  <input class=radio type=radio name=talk_cfg_key_down_call value=1 ><div class="l40 radio_text"><?cgi string=str.down_calling ?></div>
	</DIV>
      </DIV>
      <DIV class=class_row style="display:none;">
        <DIV class=class_col1><?cgi string=str.join_talking ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=talk_cfg_enable_join value=0 ><div class="l40 radio_text"><?cgi string=str.disable ?></div>
	  <input class=radio type=radio name=talk_cfg_enable_join value=1 ><div class="l40 radio_text"><?cgi string=str.enable ?></div>
	</DIV>
      </DIV>
      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talking ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=terminal_hangup value=0 ><div class="l40 radio_text"><?cgi string=str.unable_hang ?></div>
	  <input class=radio type=radio name=terminal_hangup value=1 ><div class="l40 radio_text"><?cgi string=str.enable_hang ?></div>
	</DIV>
      </DIV>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talking ?>:</DIV>
        <DIV class=class_col2>
          <input class=radio type=radio name=terminal_auto_answer value=0 ><div class="l40 radio_text"><?cgi string=str.manul_access ?></div>
	  <input class=radio type=radio name=terminal_auto_answer value=1 ><div class="l40 radio_text"><?cgi string=str.auto_access ?></div>
	</DIV>
      </DIV>

	  <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.display_othervideo ?>:</DIV>
        <DIV class=class_col2>
	  <input class=radio type=radio name=talk_cfg_display_enable value=1 ><div class="l40 radio_text"><?cgi string=str.enable_use ?></div>
          <input class=radio type=radio name=talk_cfg_display_enable value=0 ><div class="l40 radio_text"><?cgi string=str.disable_use ?></div>
	</DIV>
      </DIV>
	  
      <DIV class=class_row style="display:none;">
        <DIV class=class_col1><?cgi string=str.auto_access_waiting_time ?>:</DIV>
        <DIV class=class_col2>
            <select name=talk_cfg_waiting_time class="l100" >
            <script>select_option(0, 31, 0, "", "s");</script>
            </select>
	</DIV>
      </DIV>

      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talk_echo ?>:</DIV>
        <DIV class=class_col2>
	  <input class=radio type=radio name=talk_cfg_echo value=1 ><div class="l40 radio_text"><?cgi string=str.enable_use ?></div>
          <input class=radio type=radio name=talk_cfg_echo value=0 ><div class="l40 radio_text"><?cgi string=str.disable_use ?></div>
	</DIV>
      </DIV>
      <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.talk_environment ?>:</DIV>
        <DIV class=class_col2>
	  <input class=radio type=radio name=talk_cfg_environment value=0 ><div class="l40 radio_text"><?cgi string=str.indoor ?></div>
          <input class=radio type=radio name=talk_cfg_environment value=1 ><div class="l40 radio_text"><?cgi string=str.outdoor ?></div>
	  <input class=radio type=radio name=talk_cfg_environment value=2 ><div class="l40 radio_text"><?cgi string=str.noise ?></div>
	</DIV>
      </DIV>
	  
	  <DIV class=class_row>
        <DIV class=class_col1><?cgi string=str.call_type ?>:</DIV>
        <DIV class=class_col2>
            <select name=board_1_call_type id=board_1_call_type class="l100"  onchange="call_type(this.value);">
				<option value=1 onclick="call_type(1);"><?cgi string=str.intercom ?>
				<option value=2 onclick="call_type(2);">SIP
				<!--<option value=3 onclick="call_type(3);"><?cgi string=str.phone ?>-->
            </select>
	</DIV>
      </DIV>

	  <div id="id_div_phone_mast" class=c_none >
      <DIV class=class_row >
        <DIV class=class_col1><?cgi string=str.phone_target ?>1:</DIV>
        <DIV class=class_col2>
                 <INPUT class="text l100" maxLength=15 id=board_1_phone_num1 name=board_1_phone_num1 value="" >&nbsp;
	</DIV>
      </DIV>
      <DIV class=class_row >
        <DIV class=class_col1><?cgi string=str.phone_target ?>2:</DIV>
        <DIV class=class_col2>
                 <INPUT class="text l100" maxLength=15 id=board_1_phone_num2 name=board_1_phone_num2 value="" >&nbsp;
	</DIV>
      </DIV>
	  </div><!-- id_div_phone_mast -->
  </div><!-- div_main -->
  <DIV class=class_row1>
    <DIV class=class_r1c1>
      <INPUT class=button value=<?cgi string=str.save ?> type=submit >&nbsp; 
    </DIV>
  </DIV>
  </div><!-- div_main_edge -->
</DIV>
       </FORM>
</CENTER>

<!-- ************* help page , must add iniHelpButton() in js segment ****************** -->
<div class="help_container">
  <div class="help_left"><div class="help_top_space"></div><div class="help_button_0" id="help_button" ></div></div>
  <div class="help_right_0" id="help_right">
    <div class="help_head" ><?cgi string=str.help_message ?></div>
    <iframe name=help class="help_text" frameBorder=0 src="" ></iframe>
  </div>
</div>
<!-- ************* help page end ****************** -->

</BODY>

<script language="javascript">
function bd_load(){
  window.frames["db"].document.location="/ini/sys_cfg.txt?time="+(new Date()).getTime();
  var ret = location.toString().substring(location.toString().lastIndexOf("/")+1, location.toString().indexOf(".htm")+4);
  window.frames["help"].document.location="/cache/Help"+ret+"?time="+(new Date()).getTime();
  iniHelpButton();
}

function db_load(){
  var str=window.frames["db"].document.body.innerHTML;
  str = str.replace("<pre>", "");
  str = str.replace("</pre>", "");
  str = str.replace("<PRE>", "");
  str = str.replace("</PRE>", "");

  var db=ini2json(str);
  
  document.forms[0].talk_cfg_volume_in.selectedIndex = parseInt(db.talk_cfg.volume_in);
  document.forms[0].talk_cfg_volume_out.selectedIndex = parseInt(db.talk_cfg.volume_out);
  document.forms[0].talk_cfg_volume_ring.selectedIndex = parseInt(db.talk_cfg.volume_ring);
  document.forms[0].talk_cfg_waiting_time.selectedIndex = parseInt(db.talk_cfg.waiting_time);
  document.forms[0].board_1_phone_num1.value=db.board_1.phone_num1;
  document.forms[0].board_1_phone_num2.value=db.board_1.phone_num2;
  //document.forms[0].board_1_phone_enable.value=db.board_1.phone_enable;
  
  document.forms[0].board_1_call_type.selectedIndex = parseInt(db.board_1.call_type) - 1;
  
  put_radio("talk_cfg_is_pcm",parseInt(db.talk_cfg.is_pcm) );
  put_radio("talk_cfg_sample",parseInt(db.talk_cfg.sample) );
  put_radio("talk_cfg_mode_in",parseInt(db.talk_cfg.mode_in) );
  put_radio("talk_cfg_mode_out",parseInt(db.talk_cfg.mode_out) );
  put_radio("talk_cfg_key_down_call",parseInt(db.talk_cfg.key_down_call) );
  put_radio("talk_cfg_enable_join",parseInt(db.talk_cfg.enable_join) );
  put_radio("terminal_hangup",parseInt(db.terminal.hangup) );
  put_radio("terminal_auto_answer",parseInt(db.terminal.auto_answer) );
  put_radio("talk_cfg_echo",parseInt(db.talk_cfg.echo) );
  put_radio("talk_cfg_environment",parseInt(db.talk_cfg.environment) );
  put_radio("talk_cfg_display_enable",parseInt(db.talk_cfg.display_enable) );
  
  //divDecode(document.forms[0].board_1_phone_num.value);
  call_type(parseInt(db.board_1.call_type));
}
/*
function divEncode(){
  var ret="";
  ret += document.forms[0].board_1_phone_num_1.value;
  ret += ".";
  ret += document.forms[0].board_1_phone_num_2.value;
  ret += ".";
  return ret;
}*/

function call_type(type){
  var str=window.frames["db"].document.body.innerHTML;
  str = str.replace("<pre>", "");
  str = str.replace("</pre>", "");
  str = str.replace("<PRE>", "");
  str = str.replace("</PRE>", "");
  var db=ini2json(str);
  if(type < 2){
    $("id_div_phone_mast").className="c_none";
  }else{
    $("id_div_phone_mast").className="c_block";
  }
  
}

function on_submit(){
  var res;
  var str=window.frames["db"].document.body.innerHTML;
  str = str.replace("<pre>", "");
  str = str.replace("</pre>", "");
  str = str.replace("<PRE>", "");
  str = str.replace("</PRE>", "");
 
  var db=ini2json(str);

	if(document.getElementById("board_1_call_type").value==2 && (parseInt(db.sip.enable)==0))
	 {
		if(db.language.language==1)
		alert("SIP功能已禁用，无法使用此呼叫类型，请选择其他呼叫类型或者先开启SIP");
		else
		alert("SIP function is disabled, it can`t use this calling style, please choose other calling style or open the SIP function;");
		
		if(parseInt(db.board_1.call_type) != 2)
		document.getElementById("board_1_call_type").value=parseInt(db.board_1.call_type);
		else
		document.getElementById("board_1_call_type").value=1;
	 }
	else{
		  if(document.getElementById("board_1_call_type").value==3&& (parseInt(db.board_1.phone_enable)==0))
		 {
			 if(db.language.language==1)
				alert("未检测到电话模块，无法使用此呼叫类型，请选择其他呼叫类型");
			 else
				alert("It haven`t detect the telephone mode, so it can`t use this calling style, please choose other calling style");
			if(parseInt(db.board_1.call_type) != 3)
			document.getElementById("board_1_call_type").value=parseInt(db.board_1.call_type);
			else
			document.getElementById("board_1_call_type").value=1;
		 }
	}
	$("id_obj_ret").value=urlEncode($("id_obj_ret").value);
	//document.forms[0].board_1_phone_num.value = divEncode();
	return true;

}
/*
function divDecode(str){
  var obj;
  var ret="";
  obj=str.split(".");
  document.forms[0].board_1_phone_num_1.value=obj[0];
  document.forms[0].board_1_phone_num_2.value=obj[1];
}*/
</script>
</HTML>
